"use strict";(globalThis.webpackChunk_openmrs_esm_laboratory_app=globalThis.webpackChunk_openmrs_esm_laboratory_app||[]).push([[6676],{1132:(e,n,t)=>{t.d(n,{c:()=>l});var r=t(8276),a=t.n(r),o=t(8600),c=t.n(o)()(a());c.push([e.id,"section{margin:.5rem}.-esm-laboratory__reject-lab-request-modal__sectionTitle___gaIOa{margin-bottom:.75rem}.-esm-laboratory__reject-lab-request-modal__modalBody___zbvTZ{padding-bottom:1rem}","",{version:3,sources:["webpack://./src/lab-tabs/modals/reject-lab-request-modal.scss","webpack://./node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAEA,QACE,YCkBW,CDfb,iEACE,oBCmBW,CDhBb,8DACE,mBCoBW",sourcesContent:["@use '@carbon/layout';\n\nsection {\n  margin: layout.$spacing-03;\n}\n\n.sectionTitle {\n  margin-bottom: layout.$spacing-04;\n}\n\n.modalBody {\n  padding-bottom: layout.$spacing-05;\n}\n","// Code generated by @carbon/layout. DO NOT EDIT.\n//\n// Copyright IBM Corp. 2018, 2023\n//\n// This source code is licensed under the Apache-2.0 license found in the\n// LICENSE file in the root directory of this source tree.\n//\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-01: 0.125rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-02: 0.25rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-03: 0.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-04: 0.75rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-05: 1rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-06: 1.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-07: 2rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-08: 2.5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-09: 3rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-10: 4rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-11: 5rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-12: 6rem !default;\n\n/// @type Number\n/// @access public\n/// @group @carbon/layout\n$spacing-13: 10rem !default;\n\n/// @type Map\n/// @access public\n/// @group @carbon/layout\n$spacing: (\n  spacing-01: $spacing-01,\n  spacing-02: $spacing-02,\n  spacing-03: $spacing-03,\n  spacing-04: $spacing-04,\n  spacing-05: $spacing-05,\n  spacing-06: $spacing-06,\n  spacing-07: $spacing-07,\n  spacing-08: $spacing-08,\n  spacing-09: $spacing-09,\n  spacing-10: $spacing-10,\n  spacing-11: $spacing-11,\n  spacing-12: $spacing-12,\n  spacing-13: $spacing-13,\n);\n"],sourceRoot:""}]),c.locals={sectionTitle:"-esm-laboratory__reject-lab-request-modal__sectionTitle___gaIOa",modalBody:"-esm-laboratory__reject-lab-request-modal__modalBody___zbvTZ"};const l=c},6676:(e,n,t)=>{t.r(n),t.d(n,{default:()=>A});var r=t(7244),a=t.n(r),o=t(4524),c=t(4652),l=t(8704),i=t(5732),u=t(3604),s=t.n(u),p=t(7200),d=t.n(p),m=t(8272),b=t.n(m),f=t(712),y=t.n(f),g=t(6768),h=t.n(g),v=t(2116),_=t.n(v),C=t(1132),E={};E.styleTagTransform=_(),E.setAttributes=y(),E.insert=b().bind(null,"head"),E.domAPI=d(),E.insertStyleElement=h(),s()(C.c,E);const T=C.c&&C.c.locals?C.c.locals:void 0;var $=t(5144);function N(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function S(e,n,t,r,a,o,c){try{var l=e[o](c),i=l.value}catch(e){return void t(e)}l.done?n(i):Promise.resolve(i).then(r,a)}function w(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,o=[],c=!0,l=!1;try{for(t=t.call(e);!(c=(r=t.next()).done)&&(o.push(r.value),!n||o.length!==n);c=!0);}catch(e){l=!0,a=e}finally{try{c||null==t.return||t.return()}finally{if(l)throw a}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return N(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?N(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const A=function(e){var n,t,u,s=e.order,p=e.closeModal,d=(0,c.useTranslation)().t,m=w((0,r.useState)(""),2),b=m[0],f=m[1],y=(0,l.useAbortController)(),g=w((0,r.useState)(!1),2),h=g[0],v=g[1],_=(0,l.useConfig)().laboratoryOrderTypeUuid,C=(t=function(e){return function(e,n){var t,r,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return c.label++,{value:o[1],done:!1};case 5:c.label++,r=o[1],o=[0];continue;case 7:o=c.ops.pop(),c.trys.pop();continue;default:if(!((a=(a=c.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){c=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){c.label=o[1];break}if(6===o[0]&&c.label<a[1]){c.label=a[1],a=o;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(o);break}a[2]&&c.ops.pop(),c.trys.pop();continue}o=n.call(e,c)}catch(e){o=[6,e],r=0}finally{t=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(n){return e.preventDefault(),v(!0),(0,i.E9)(s.uuid,b,y).then((function(){(0,$.Uz)((function(e){return"string"==typeof e&&e.startsWith("".concat(l.restBaseUrl,"/order?orderTypes=").concat(_))}),void 0,{revalidate:!0}),v(!1),p(),(0,l.showSnackbar)({isLowContrast:!0,title:d("rejectLabRequestTitle","Lab request rejected"),kind:"success",subtitle:d("rejectLabRequestSuccessMessage",'Lab request with order number "{{orderNumber}}" rejected successfully',{orderNumber:s.orderNumber})})}),(function(e){v(!1),(0,l.showNotification)({title:d("errorRejectingRequest","Error rejecting lab request"),kind:"error",critical:!0,description:null==e?void 0:e.message})})),[2]}))},u=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function c(e){S(o,r,a,c,l,"next",e)}function l(e){S(o,r,a,c,l,"throw",e)}c(void 0)}))},function(e){return u.apply(this,arguments)});return a().createElement(o.QFz,{onSubmit:C},a().createElement(o.kPY,{closeModal:p,title:"".concat(d("rejectLabRequest","Reject lab request")," [").concat(s.orderNumber,"]")}),a().createElement(o.aUI,null,a().createElement("div",{className:T.modalBody},a().createElement(o.ar0,null,a().createElement("p",{className:T.section},"".concat(d("testType","Test type"),": ").concat(null===(n=s.concept)||void 0===n?void 0:n.display))),a().createElement("br",null),a().createElement(o.ar0,null,a().createElement(o.IF6,{labelText:d("fulfillerComment","Fulfiller comment"),id:"commentField",maxCount:500,enableCounter:!0,onChange:function(e){return f(e.target.value)}})))),a().createElement(o._AC,null,a().createElement(o.qaq,{kind:"secondary",onClick:p},d("cancel","Cancel")),a().createElement(o.qaq,{kind:"danger",type:"submit",disabled:h},d("reject","Reject"))))}},5732:(e,n,t)=>{t.d(n,{A5:()=>i,E9:()=>p,_u:()=>s,w9:()=>u});var r=t(7244),a=t(6192),o=t.n(a),c=t(5144),l=t(8704);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=(null!==(e=(0,l.useAppContext)("laboratory-date-filter"))&&void 0!==e?e:{dateRange:[o()().startOf("day").toDate(),new Date]}).dateRange,i=(0,l.useConfig)().laboratoryOrderTypeUuid,u=(0,r.useMemo)((function(){return"NEW"===n?null:n}),[n]),s="NEW"===n,p="".concat(l.restBaseUrl,"/order?orderTypes=").concat(i,"&v=").concat("custom:(uuid,orderNumber,patient:(uuid,display,person:(uuid,display,age)),concept:(uuid,display),action,careSetting:(uuid,display,description,careSettingType,display),previousOrder,dateActivated,scheduledDate,dateStopped,autoExpireDate,encounter:(uuid,display),orderer:(uuid,display),orderReason,orderReasonNonCoded,orderType:(uuid,display,name,description,conceptClasses,parent),urgency,instructions,commentToFulfiller,display,fulfillerStatus,fulfillerComment,specimenSource,laterality,clinicalHistory,frequency,numberOfRepeats)");p=u?p+"&fulfillerStatus=".concat(u):p,p=t?"".concat(p,"&excludeCanceledAndExpired=true&excludeDiscontinueOrders=true"):p,p=a?"".concat(p,"&=&activatedOnOrAfterDate=").concat(a.at(0).toISOString(),"&activatedOnOrBeforeDate=").concat(a.at(1).toISOString()):p;var d=(0,c.cp)("".concat(p),l.openmrsFetch),m=d.data,b=d.error,f=d.mutate,y=d.isLoading,g=d.isValidating;return{labOrders:(null==m?void 0:m.data)&&s&&m.data.results.filter((function(e){return"NEW"===(null==e?void 0:e.action)&&null===(null==e?void 0:e.fulfillerStatus)}))||(null==m?void 0:m.data.results)||[],isLoading:y,isError:b,mutate:f,isValidating:g}}function u(e,n){return(0,r.useMemo)((function(){if(n&&""!==n.trim()){var t=n.toLowerCase();return e.filter((function(e){return e.orders.some((function(e){return e.orderNumber.toLowerCase().includes(t)||e.patient.display.toLowerCase().includes(t)}))}))}return e}),[n,e])}function s(e,n,t){return(0,l.openmrsFetch)("".concat(l.restBaseUrl,"/order/").concat(e,"/fulfillerdetails/"),{method:"POST",headers:{"Content-Type":"application/json"},signal:t.signal,body:{fulfillerStatus:n}})}function p(e,n,t){return(0,l.openmrsFetch)("".concat(l.restBaseUrl,"/order/").concat(e,"/fulfillerdetails/"),{method:"POST",headers:{"Content-Type":"application/json"},signal:t.signal,body:{fulfillerStatus:"DECLINED",fulfillerComment:n}})}}}]);